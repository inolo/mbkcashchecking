{% extends "layout.html" %}
{% block css %}
.customer-details, .orders-section {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
        }

        .customer-details h2, .orders-section h3 {
            color: #007bff;
            margin-bottom: 15px;
        }

        .customer-details p, .orders-section p {
            line-height: 1.6;
            color: #333333;
        }

        .custom-table th {
            background-color: #007bff;
            color: white;
        }

        .custom-table td, .custom-table th {
            text-align: left;
            padding: 8px;
        }

        .custom-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .custom-table {
            width: 100%;
            border-collapse: collapse;
        }
            .customer-details-row {
            display: flex;
            align-items: start;
            gap: 20px;
            margin-bottom: 20px;
        }



        .customer-details, .customer-image, .customer-license {
            flex: 1;
            }
            .customer-image img, .customer-license img {
        width: 640px; /* Set the width to 640px */
        height: 480px; /* Set the height to 480px */
        object-fit: cover; /* This will ensure the aspect ratio is maintained */
        border-radius: 8px;
    }
    .customer-profile {
    display: flex;
    flex-direction: column;
    align-items: center; /* Center the items vertically */
    gap: 20px; /* Space between images and details */
}

.customer-images {
    display: flex;
    flex-direction: row;
    gap: 20px; /* Space between the two images */
}

.customer-image img, .customer-license img {
    width: 640px; /* Set the width to 640px */
    height: 480px; /* Set the height to 480px */
    object-fit: cover; /* This will ensure the aspect ratio is maintained */
    border-radius: 8px;
}

.customer-details {
    width: 100%; /* Adjust the width as needed */
    /* Additional styling for customer details */
}

{% endblock %}

//////////////////////////////////////////////////////////////////////////


{% block main %}
<div class="main-content" id="mainContent">

       <div class="customer-profile">
        <!-- Container for Images -->
        <div class="customer-images">
            <div class="customer-image">
                <img src="{{ url_for('static', filename='images/customer_photo/' + customer.uuid  +'.png' )}}" alt="Customer Image">
            </div>
            <div class="customer-license">
                <img src="{{ url_for('static', filename='images/license_copy/' +  customer.uuid  +'.png' ) }}" alt="Customer License">
            </div>
        </div>

        <!-- Customer Details -->
        <div class="customer-details">
            <!-- ... [customer details] ... -->
                                    <h2>Customer Details</h2>
        <div class="customer-details">
            <p id="cust_id"><strong>ID:</strong> {{ customer.id }}</p>
            <p><strong>First Name:</strong> {{ customer.first_name }}</p>
            <p><strong>Last Name:</strong> {{ customer.last_name }}</p>
            <p><strong>Phone Number:</strong> {{ customer.phone_number }}</p>
            <p><strong>Address:</strong> {{ customer.address }}</p>
            <p><strong>License Number:</strong> {{ customer.license_number }}</p>
            <p><strong>Account Creation Date:</strong> {{ customer.account_creation }}</p>
            <p><strong>Last Cashed Check Date:</strong> {{ customer.last_checked }}</p>
            {% if customer.is_flagged%}
                <p><strong>Is Flagged: </strong>YES</p>
            {% else %}
                <p><strong>Is Flagged: </strong>NO</p>
            {% endif %}
            <!-- Add more details as needed -->
            <p><strong>Store:</strong> {{ customer.store }}</p>
            {% if customer.old_id %}
            <p><strong>Conoco OLD ID:</strong> {{ customer.old_id }}</p>
            {% endif %}
            <div class="customer-notes">
            <h3>Notes</h3>
            <textarea id="customerNotes" rows="4" style="width: 100%;">{{ customer.notes }}</textarea>
            <button id="saveNotes" type="button" class="btn btn-primary">Save Notes</button>
        </div>
        </div>
            <button id="flagaccount" type="button">Flag Account</button>
            <button id="unflagaccount" type="button">Unflag Account</button>
        </div>
    </div>

<!--          <div class="customer-profile">-->
<!--        <div class="customer-image">-->
<!--              <img src="{{ url_for('static', filename='images/customer_photo/' + customer.uuid  +'.png' )}}" alt="Customer Image">-->
<!--        </div>-->
<!--        <div class="customer-license">-->
<!--            <img src="{{ url_for('static', filename='images/license_copy/' +  customer.uuid  +'.png' ) }}" alt="Customer License">-->
<!--        </div>-->
<!--        <div class="customer-details">-->
<!--            &lt;!&ndash; Customer Details &ndash;&gt;-->
<!--            &lt;!&ndash; ... [customer details] ... &ndash;&gt;-->
<!--                        <h2>Customer Details</h2>-->
<!--        <div class="customer-details">-->
<!--            <p><strong>ID:</strong> {{ customer.id }}</p>-->
<!--            <p><strong>First Name:</strong> {{ customer.first_name }}</p>-->
<!--            <p><strong>Last Name:</strong> {{ customer.last_name }}</p>-->
<!--            <p><strong>Phone Number:</strong> {{ customer.phone_number }}</p>-->
<!--            <p><strong>Address:</strong> {{ customer.address }}</p>-->
<!--            <p><strong>License Number:</strong> {{ customer.license_number }}</p>-->
<!--            <p><strong>Account Creation Date:</strong> {{ customer.account_creation }}</p>-->
<!--            <p><strong>Last Cashed Check Date:</strong> {{ customer.last_checked }}</p>-->
<!--            &lt;!&ndash; Add more details as needed &ndash;&gt;-->
<!--        </div>-->
<!--        </div>-->
<!--    </div>-->
<!--        <div class="customer-details-row">-->
<!--        <div class="customer-image">-->
<!--            <img src="{{ url_for('static', filename='images/customer_photo/' + customer.uuid  +'.png' )}}" alt="Customer Image">-->
<!--        </div>-->
<!--        <div class="customer-details">-->

<!--        </div>-->
<!--        <div class="customer-license">-->
<!--            <img src="{{ url_for('static', filename='images/license_copy/' +  customer.uuid  +'.png' ) }}" alt="Customer License">-->
<!--        </div>-->
<!--            <h2>Customer Details</h2>-->
<!--        <div class="customer-details">-->
<!--            <p><strong>ID:</strong> {{ customer.id }}</p>-->
<!--            <p><strong>First Name:</strong> {{ customer.first_name }}</p>-->
<!--            <p><strong>Last Name:</strong> {{ customer.last_name }}</p>-->
<!--            <p><strong>Phone Number:</strong> {{ customer.phone_number }}</p>-->
<!--            <p><strong>Address:</strong> {{ customer.address }}</p>-->
<!--            <p><strong>License Number:</strong> {{ customer.license_number }}</p>-->
<!--            <p><strong>Account Creation Date:</strong> {{ customer.account_creation }}</p>-->
<!--            <p><strong>Last Cashed Check Date:</strong> {{ customer.last_checked }}</p>-->
<!--            &lt;!&ndash; Add more details as needed &ndash;&gt;-->
<!--        </div>-->
<!--    </div>-->

        <h3>Orders</h3>
        <table class="custom-table">
            <thead>
                <tr>
                    <th>Order Number</th>
                    <th>Order Creation Date</th>
                    <th>Date Check Issued</th>
                    <th>Check Number</th>
                    <th>Amount</th>
                    <th>Amount Issued</th>
                </tr>
            </thead>
            <tbody>
                {% for order in customer_orders %}
                    <tr>
                        <td><a href="/order/{{ order.order_number }}" class="clickable">{{ order.order_number }}</a></td>
                        <td>{{ order.order_create_date }}</td>
                        <td>{{ order.date_check_issued }}</td>
                        <td>{{ order.check_number }}</td>
                        <td>{{ order.amount }}</td>
                        <td>{{ order.amount_issued }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}

///////////////////////////////////////////////////////////////////////////

{% block js %}
 let saveNotes = document.getElementById('saveNotes');

        saveNotes.addEventListener('click', function () {
            var notes = document.getElementById('customerNotes').value;
            var customerId = document.getElementById('cust_id').innerText;
        fetch('/save_notes', {
                method: 'POST',
                 body: JSON.stringify({ customerId: customerId, notes: notes }),
            })
            .then(response => {
                if (response.ok) {
                    console.log('Image uploaded successfully.');
                    window.location.reload();
                } else {
                    console.error('Image upload failed.');
                }


        });
     });
        let flagaccount = document.getElementById('flagaccount');

        flagaccount.addEventListener('click', function () {
        console.log('I am here');
         var pValue = document.getElementById('cust_id').innerText;
         console.log(pValue);
        fetch('/flag_account', {
                method: 'POST',
                body: JSON.stringify({ pTagValue: pValue }),
            })
            .then(response => {
                if (response.ok) {
                    console.log('Image uploaded successfully.');
                    window.location.reload();
                } else {
                    console.error('Image upload failed.');
                }


        });
     });

      let unflagaccount = document.getElementById('unflagaccount');

        unflagaccount.addEventListener('click', function () {
         var pValue = document.getElementById('cust_id').innerText;
         console.log(pValue);
        fetch('/unflag_account', {
                method: 'POST',
                body: JSON.stringify({ pTagValue: pValue }),
            })
            .then(response => {
                if (response.ok) {
                    console.log('Image uploaded successfully.');
                    window.location.reload();
                } else {
                    console.error('Image upload failed.');
                }


        });
     });
{% endblock %}

