<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cash Checking App</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<!--    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>-->
<!--     <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>-->
    <style>
        /* Custom styles for sidebar */
        .sidebar {
            height: calc(100vh - 56px);
            width: 200px;
            position: fixed;
            z-index: 1;
            top: 56px;
            left: -200px; /* Initially hidden */
            background-color: #f8f9fa;
            overflow-x: hidden;
            padding-top: 20px;
            transition: 0.5s; /* Smooth transition */
        }

        .sidebar a {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            font-size: 16px;
            color: #333;
            display: block;
        }

        .sidebar a:hover {
            color: #007bff;
        }

        /* Style for the content */
        .main-content {
            transition: margin-left .5s; /* Smooth transition */
            padding: 20px;
        }

        /* When the sidebar is shown, add 200px margin */
        .main-content.shift-right {
            margin-left: 200px;
        }

        /* Navigation Bar */
        .navbar {
            z-index: 2; /* Ensure navbar is above sidebar */
        }
        body {
            cursor: default;
        }

        a, button {
            cursor: pointer;
        }
        .customer-details, .orders-section {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
        }

        .customer-details h2, .orders-section h3 {
            color: #007bff;
            margin-bottom: 15px;
        }

        .customer-details p, .orders-section p {
            line-height: 1.6;
            color: #333333;
        }

        .custom-table th {
            background-color: #007bff;
            color: white;
        }

        .custom-table td, .custom-table th {
            text-align: left;
            padding: 8px;
        }

        .custom-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .custom-table {
            width: 100%;
            border-collapse: collapse;
        }
            .customer-details-row {
            display: flex;
            align-items: start;
            gap: 20px;
            margin-bottom: 20px;
        }



        .customer-details, .customer-image, .customer-license {
            flex: 1;
            }
            .customer-image img, .customer-license img {
        width: 640px; /* Set the width to 640px */
        height: 480px; /* Set the height to 480px */
        object-fit: cover; /* This will ensure the aspect ratio is maintained */
        border-radius: 8px;
    }
    .customer-profile {
    display: flex;
    flex-direction: column;
    align-items: center; /* Center the items vertically */
    gap: 20px; /* Space between images and details */
}

.customer-images {
    display: flex;
    flex-direction: row;
    gap: 20px; /* Space between the two images */
}

.customer-image img, .customer-license img {
    width: 640px; /* Set the width to 640px */
    height: 480px; /* Set the height to 480px */
    object-fit: cover; /* This will ensure the aspect ratio is maintained */
    border-radius: 8px;
}

.customer-details {
    width: 100%; /* Adjust the width as needed */
    /* Additional styling for customer details */
}

    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <span style="color: white; cursor: pointer" class="navbar-brand" onclick="toggleSidebar()">
            &#9776; <!-- Unicode for menu icon -->
        </span>
        <a class="navbar-brand" href="/">CashCheck</a>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
               {% if current_user.is_active %}
                <li class="nav-item">
                    <a class="nav-link" href="/logout">Log Out</a>
                </li>
                {% else %}
                <li class="nav-item">
                    <a class="nav-link" href="/login">Login</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/support">Support</a>
                </li>
                {% endif %}
            </ul>
        </div>
    </nav>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <a href="/orders">Orders</a>
        <a href="/customers">Customers</a>
        <a href="/reports">Reports</a>
    </div>

    <!-- Main Content -->
   <div class="main-content" id="mainContent">

       <div class="customer-profile">
        <!-- Container for Images -->
        <div class="customer-images">
            <div class="customer-image">
                <img src="{{ url_for('static', filename='images/customer_photo/' + customer.uuid  +'.png' )}}" alt="Customer Image">
            </div>
            <div class="customer-license">
                <img src="{{ url_for('static', filename='images/license_copy/' +  customer.uuid  +'.png' ) }}" alt="Customer License">
            </div>
        </div>

        <!-- Customer Details -->
        <div class="customer-details">
            <!-- ... [customer details] ... -->
                                    <h2>Customer Details</h2>
        <div class="customer-details">
            <p id="cust_id"><strong>ID:</strong> {{ customer.id }}</p>
            <p><strong>First Name:</strong> {{ customer.first_name }}</p>
            <p><strong>Last Name:</strong> {{ customer.last_name }}</p>
            <p><strong>Phone Number:</strong> {{ customer.phone_number }}</p>
            <p><strong>Address:</strong> {{ customer.address }}</p>
            <p><strong>License Number:</strong> {{ customer.license_number }}</p>
            <p><strong>Account Creation Date:</strong> {{ customer.account_creation }}</p>
            <p><strong>Last Cashed Check Date:</strong> {{ customer.last_checked }}</p>
            {% if customer.is_flagged%}
                <p><strong>Is Flagged: </strong>YES</p>
            {% else %}
                <p><strong>Is Flagged: </strong>NO</p>
            {% endif %}
            <!-- Add more details as needed -->
            <div class="customer-notes">
            <h3>Notes</h3>
            <textarea id="customerNotes" rows="4" style="width: 100%;">{{ customer.notes }}</textarea>
            <button id="saveNotes" type="button" class="btn btn-primary">Save Notes</button>
        </div>
        </div>
            <button id="flagaccount" type="button">Flag Account</button>
            <button id="unflagaccount" type="button">Unflag Account</button>
        </div>
    </div>

<!--          <div class="customer-profile">-->
<!--        <div class="customer-image">-->
<!--              <img src="{{ url_for('static', filename='images/customer_photo/' + customer.uuid  +'.png' )}}" alt="Customer Image">-->
<!--        </div>-->
<!--        <div class="customer-license">-->
<!--            <img src="{{ url_for('static', filename='images/license_copy/' +  customer.uuid  +'.png' ) }}" alt="Customer License">-->
<!--        </div>-->
<!--        <div class="customer-details">-->
<!--            &lt;!&ndash; Customer Details &ndash;&gt;-->
<!--            &lt;!&ndash; ... [customer details] ... &ndash;&gt;-->
<!--                        <h2>Customer Details</h2>-->
<!--        <div class="customer-details">-->
<!--            <p><strong>ID:</strong> {{ customer.id }}</p>-->
<!--            <p><strong>First Name:</strong> {{ customer.first_name }}</p>-->
<!--            <p><strong>Last Name:</strong> {{ customer.last_name }}</p>-->
<!--            <p><strong>Phone Number:</strong> {{ customer.phone_number }}</p>-->
<!--            <p><strong>Address:</strong> {{ customer.address }}</p>-->
<!--            <p><strong>License Number:</strong> {{ customer.license_number }}</p>-->
<!--            <p><strong>Account Creation Date:</strong> {{ customer.account_creation }}</p>-->
<!--            <p><strong>Last Cashed Check Date:</strong> {{ customer.last_checked }}</p>-->
<!--            &lt;!&ndash; Add more details as needed &ndash;&gt;-->
<!--        </div>-->
<!--        </div>-->
<!--    </div>-->
<!--        <div class="customer-details-row">-->
<!--        <div class="customer-image">-->
<!--            <img src="{{ url_for('static', filename='images/customer_photo/' + customer.uuid  +'.png' )}}" alt="Customer Image">-->
<!--        </div>-->
<!--        <div class="customer-details">-->

<!--        </div>-->
<!--        <div class="customer-license">-->
<!--            <img src="{{ url_for('static', filename='images/license_copy/' +  customer.uuid  +'.png' ) }}" alt="Customer License">-->
<!--        </div>-->
<!--            <h2>Customer Details</h2>-->
<!--        <div class="customer-details">-->
<!--            <p><strong>ID:</strong> {{ customer.id }}</p>-->
<!--            <p><strong>First Name:</strong> {{ customer.first_name }}</p>-->
<!--            <p><strong>Last Name:</strong> {{ customer.last_name }}</p>-->
<!--            <p><strong>Phone Number:</strong> {{ customer.phone_number }}</p>-->
<!--            <p><strong>Address:</strong> {{ customer.address }}</p>-->
<!--            <p><strong>License Number:</strong> {{ customer.license_number }}</p>-->
<!--            <p><strong>Account Creation Date:</strong> {{ customer.account_creation }}</p>-->
<!--            <p><strong>Last Cashed Check Date:</strong> {{ customer.last_checked }}</p>-->
<!--            &lt;!&ndash; Add more details as needed &ndash;&gt;-->
<!--        </div>-->
<!--    </div>-->

        <h3>Orders</h3>
        <table class="custom-table">
            <thead>
                <tr>
                    <th>Order Number</th>
                    <th>Order Creation Date</th>
                    <th>Date Check Issued</th>
                    <th>Check Number</th>
                    <th>Amount</th>
                    <th>Amount Issued</th>
                </tr>
            </thead>
            <tbody>
                {% for order in customer_orders %}
                    <tr>
                        <td><a href="/order/{{ order.order_number }}" class="clickable">{{ order.order_number }}</a></td>
                        <td>{{ order.order_create_date }}</td>
                        <td>{{ order.date_check_issued }}</td>
                        <td>{{ order.check_number }}</td>
                        <td>{{ order.amount }}</td>
                        <td>{{ order.amount_issued }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <script>
        function toggleSidebar() {
            var sidebar = document.getElementById("sidebar");
            var mainContent = document.getElementById("mainContent");
            if (sidebar.style.left === "-200px") {
                sidebar.style.left = "0";
                mainContent.classList.add("shift-right");
            } else {
                sidebar.style.left = "-200px";
                mainContent.classList.remove("shift-right");
            }
        }
        let saveNotes = document.getElementById('saveNotes');

        saveNotes.addEventListener('click', function () {
            var notes = document.getElementById('customerNotes').value;
            var customerId = document.getElementById('cust_id').innerText;
        fetch('/save_notes', {
                method: 'POST',
                 body: JSON.stringify({ customerId: customerId, notes: notes }),
            })
            .then(response => {
                if (response.ok) {
                    console.log('Image uploaded successfully.');
                    window.location.reload();
                } else {
                    console.error('Image upload failed.');
                }


        });
     });
        let flagaccount = document.getElementById('flagaccount');

        flagaccount.addEventListener('click', function () {
        console.log('I am here');
         var pValue = document.getElementById('cust_id').innerText;
         console.log(pValue);
        fetch('/flag_account', {
                method: 'POST',
                body: JSON.stringify({ pTagValue: pValue }),
            })
            .then(response => {
                if (response.ok) {
                    console.log('Image uploaded successfully.');
                    window.location.reload();
                } else {
                    console.error('Image upload failed.');
                }


        });
     });

      let unflagaccount = document.getElementById('unflagaccount');

        unflagaccount.addEventListener('click', function () {
         var pValue = document.getElementById('cust_id').innerText;
         console.log(pValue);
        fetch('/unflag_account', {
                method: 'POST',
                body: JSON.stringify({ pTagValue: pValue }),
            })
            .then(response => {
                if (response.ok) {
                    console.log('Image uploaded successfully.');
                    window.location.reload();
                } else {
                    console.error('Image upload failed.');
                }


        });
     });


    </script>
</body>
</html>
